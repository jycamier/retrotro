global:
  imageRegistry: ''
  imagePullSecrets: []
backend:
  replicaCount: 2
  image:
    repository: ghcr.io/jycamier/retrotro-backend
    tag: 0.0.2
    pullPolicy: Always
  service:
    type: ClusterIP
    port: 8080
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 128Mi
  autoscaling:
    enabled: false
    minReplicas: 2
    maxReplicas: 10
    targetCPUUtilizationPercentage: 80
  corsOrigins: http://localhost:3000
  bus:
    type: gochannel
    natsUrl: ""
  env:
    PORT: '8080'
  envFromSecrets: []
frontend:
  replicaCount: 2
  image:
    repository: ghcr.io/jycamier/retrotro-frontend
    tag: 0.0.2
    pullPolicy: Always
  service:
    type: ClusterIP
    port: 3000
  resources:
    limits:
      cpu: 200m
      memory: 256Mi
    requests:
      cpu: 50m
      memory: 64Mi
  autoscaling:
    enabled: false
    minReplicas: 2
    maxReplicas: 10
    targetCPUUtilizationPercentage: 80
  caddyfile: |
    :3000 {
        # Health check endpoint
        handle /health {
            respond "OK" 200
        }

        # Static files and SPA
        handle {
            root * /srv

            # Cache static assets
            @static {
                path *.js *.css *.png *.jpg *.jpeg *.gif *.ico *.svg *.woff *.woff2
            }
            header @static Cache-Control "public, max-age=31536000, immutable"

            # SPA fallback
            try_files {path} /index.html
            file_server
        }

        # Security headers
        header {
            X-Frame-Options "SAMEORIGIN"
            X-Content-Type-Options "nosniff"
            X-XSS-Protection "1; mode=block"
        }
    }
ingress:
  enabled: false
  className: nginx
  annotations:
    nginx.ingress.kubernetes.io/proxy-read-timeout: '3600'
    nginx.ingress.kubernetes.io/proxy-send-timeout: '3600'
    nginx.ingress.kubernetes.io/websocket-services: retrotro-backend
  hosts:
    - host: retrotro.local
      paths:
        - path: /
          pathType: Prefix
          backend: frontend
        - path: /api
          pathType: Prefix
          backend: backend
        - path: /auth
          pathType: Prefix
          backend: backend
        - path: /ws
          pathType: Prefix
          backend: backend
  tls: []
httpRoute:
  enabled: true
  annotations: {}
  gatewayName: demo-gateway
  gatewayNamespace: demo
  hostnames:
    - retrotro.k8s.camier.family
postgresql:
  enabled: true
  auth:
    database: retrotro
    username: retrotro
    password: ''
    existingSecret: ''
  primary:
    persistence:
      enabled: true
      size: 10Gi
    resources:
      limits:
        cpu: 500m
        memory: 512Mi
      requests:
        cpu: 100m
        memory: 256Mi
databaseUrl: ''
oidc:
  issuerUrl: ''
  clientId: ''
  clientSecret: ''
  existingSecret: ''
  existingSecretKey: oidc-client-secret
  redirectUrl: ''
  scopes: openid,profile,email,groups
  jit:
    enabled: true
    groupsClaim: groups
    groupsPrefix: ''
    defaultRole: member
    adminGroups: []
    facilitatorGroups: []
    syncOnLogin: true
    removeStaleMembers: false
jwt:
  secret: ''
  existingSecret: ''
  accessTokenTTL: 15
  refreshTokenTTL: 168
serviceAccount:
  create: true
  annotations: {}
  name: ''
podSecurityContext:
  runAsNonRoot: true
  runAsUser: 1000
  fsGroup: 1000
securityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  capabilities:
    drop:
      - ALL
nodeSelector: {}
tolerations: []
affinity: {}
podDisruptionBudget:
  enabled: true
  minAvailable: 1
networkPolicy:
  enabled: false
